<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-comment">-- | This modules provides an executable for running safe-rm.</span><span>
</span><span id="line-4"></span><span class="hs-comment">--</span><span>
</span><span id="line-5"></span><span class="hs-comment">-- @since 0.1</span><span>
</span><span id="line-6"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">SafeRm.Runner</span><span>
</span><span id="line-7"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- * Main functions</span></span><span>
</span><span id="line-8"></span><span>    </span><span class="annot"><a href="SafeRm.Runner.html#runSafeRm"><span class="hs-identifier">runSafeRm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>    </span><span class="annot"><a href="SafeRm.Runner.html#runCmd"><span class="hs-identifier">runCmd</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Helpers</span></span><span>
</span><span id="line-12"></span><span>    </span><span class="annot"><a href="SafeRm.Runner.html#getEnv"><span class="hs-identifier">getEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span>    </span><span class="annot"><a href="SafeRm.Runner.html#getConfiguration"><span class="hs-identifier">getConfiguration</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-14"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">where</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Encoding.html"><span class="hs-identifier">Data.Text.Encoding</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">TEnc</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Conc.Sync.html"><span class="hs-identifier">GHC.Conc.Sync</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Conc.Sync.html#setUncaughtExceptionHandler"><span class="hs-identifier">setUncaughtExceptionHandler</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SafeRm.html"><span class="hs-identifier">SafeRm</span></a></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SafeRm.Data.Paths.html"><span class="hs-identifier">SafeRm.Data.Paths</span></a></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="SafeRm.Data.Paths.html#PathI"><span class="hs-identifier">PathI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Data.Paths.html#MkPathI"><span class="hs-identifier">MkPathI</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>    </span><span class="annot"><a href="SafeRm.Data.Paths.html#PathIndex"><span class="hs-identifier">PathIndex</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Data.Paths.html#TrashHome"><span class="hs-identifier">TrashHome</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SafeRm.Data.Paths.html"><span class="hs-identifier">SafeRm.Data.Paths</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Paths</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SafeRm.Effects.MonadCallStack.html"><span class="hs-identifier">SafeRm.Effects.MonadCallStack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Effects.MonadCallStack.html#MonadCallStack"><span class="hs-identifier">MonadCallStack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="SafeRm.Effects.MonadCallStack.html#throwCallStack"><span class="hs-identifier">throwCallStack</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SafeRm.Effects.MonadFsReader.html"><span class="hs-identifier">SafeRm.Effects.MonadFsReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Effects.MonadFsReader.html#MonadFsReader"><span class="hs-identifier">MonadFsReader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Effects.MonadFsReader.html#readFile"><span class="hs-identifier">readFile</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SafeRm.Effects.MonadFsWriter.html"><span class="hs-identifier">SafeRm.Effects.MonadFsWriter</span></a></span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="SafeRm.Effects.MonadFsWriter.html#MonadFsWriter"><span class="hs-identifier">MonadFsWriter</span></a></span><span>
</span><span id="line-29"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="SafeRm.Effects.MonadFsWriter.html#createDirectoryIfMissing"><span class="hs-identifier">createDirectoryIfMissing</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>        </span><span class="annot"><a href="SafeRm.Effects.MonadFsWriter.html#hClose"><span class="hs-identifier">hClose</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>        </span><span class="annot"><a href="SafeRm.Effects.MonadFsWriter.html#hFlush"><span class="hs-identifier">hFlush</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>        </span><span class="annot"><a href="SafeRm.Effects.MonadFsWriter.html#openFile"><span class="hs-identifier">openFile</span></a></span><span>
</span><span id="line-33"></span><span>      </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SafeRm.Effects.MonadLoggerContext.html"><span class="hs-identifier">SafeRm.Effects.MonadLoggerContext</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Effects.MonadLoggerContext.html#MonadLoggerContext"><span class="hs-identifier">MonadLoggerContext</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SafeRm.Effects.MonadSystemTime.html"><span class="hs-identifier">SafeRm.Effects.MonadSystemTime</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Effects.MonadSystemTime.html#MonadSystemTime"><span class="hs-identifier">MonadSystemTime</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SafeRm.Effects.MonadTerminal.html"><span class="hs-identifier">SafeRm.Effects.MonadTerminal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Effects.MonadTerminal.html#MonadTerminal"><span class="hs-identifier">MonadTerminal</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="SafeRm.Effects.MonadTerminal.html#putTextLn"><span class="hs-identifier">putTextLn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SafeRm.Env.html"><span class="hs-identifier">SafeRm.Env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Env.html#HasTrashHome"><span class="hs-identifier">HasTrashHome</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SafeRm.Exception.html"><span class="hs-identifier">SafeRm.Exception</span></a></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="SafeRm.Exception.html#ArbitraryE"><span class="hs-identifier">ArbitraryE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Exception.html#MkArbitraryE"><span class="hs-identifier">MkArbitraryE</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><a href="SafeRm.Exception.html#TomlDecodeE"><span class="hs-identifier">TomlDecodeE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Exception.html#MkTomlDecodeE"><span class="hs-identifier">MkTomlDecodeE</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>    </span><span class="annot"><a href="SafeRm.Exception.html#displayTrace"><span class="hs-identifier">displayTrace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><a href="SafeRm.Exception.html#displayTraceIf"><span class="hs-identifier">displayTraceIf</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-44"></span><span>    </span><span class="annot"><a href="SafeRm.Exception.html#withStackTracing"><span class="hs-identifier">withStackTracing</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SafeRm.Prelude.html"><span class="hs-identifier">SafeRm.Prelude</span></a></span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SafeRm.Runner.Args.html"><span class="hs-identifier">SafeRm.Runner.Args</span></a></span><span>
</span><span id="line-48"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="SafeRm.Runner.Args.html#TomlConfigPath"><span class="hs-identifier">TomlConfigPath</span></a></span><span>
</span><span id="line-49"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="SafeRm.Runner.Args.html#TomlDefault"><span class="hs-identifier">TomlDefault</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>        </span><span class="annot"><a href="SafeRm.Runner.Args.html#TomlNone"><span class="hs-identifier">TomlNone</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-51"></span><span>        </span><span class="annot"><a href="SafeRm.Runner.Args.html#TomlPath"><span class="hs-identifier">TomlPath</span></a></span><span>
</span><span id="line-52"></span><span>      </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-53"></span><span>    </span><span class="annot"><a href="SafeRm.Runner.Args.html#getArgs"><span class="hs-identifier">getArgs</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SafeRm.Runner.Command.html"><span class="hs-identifier">SafeRm.Runner.Command</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="SafeRm.Runner.Command.html#Command"><span class="hs-identifier">Command</span></a></span><span>
</span><span id="line-57"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="SafeRm.Runner.Command.html#Delete"><span class="hs-identifier">Delete</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-58"></span><span>        </span><span class="annot"><a href="SafeRm.Runner.Command.html#DeletePerm"><span class="hs-identifier">DeletePerm</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-59"></span><span>        </span><span class="annot"><a href="SafeRm.Runner.Command.html#Empty"><span class="hs-identifier">Empty</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-60"></span><span>        </span><span class="annot"><a href="SafeRm.Runner.Command.html#List"><span class="hs-identifier">List</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-61"></span><span>        </span><span class="annot"><a href="SafeRm.Runner.Command.html#Metadata"><span class="hs-identifier">Metadata</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>        </span><span class="annot"><a href="SafeRm.Runner.Command.html#Restore"><span class="hs-identifier">Restore</span></a></span><span>
</span><span id="line-63"></span><span>      </span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SafeRm.Runner.Env.html"><span class="hs-identifier">SafeRm.Runner.Env</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="SafeRm.Runner.Env.html#Env"><span class="hs-identifier">Env</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Runner.Env.html#MkEnv"><span class="hs-identifier">MkEnv</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="SafeRm.Runner.Env.html#%24sel%3AtrashHome%3AMkEnv"><span class="hs-identifier">trashHome</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-67"></span><span>    </span><span class="annot"><a href="SafeRm.Runner.Env.html#LogEnv"><span class="hs-identifier">LogEnv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Runner.Env.html#MkLogEnv"><span class="hs-identifier">MkLogEnv</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-68"></span><span>    </span><span class="annot"><a href="SafeRm.Runner.Env.html#LogFile"><span class="hs-identifier">LogFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Runner.Env.html#MkLogFile"><span class="hs-identifier">MkLogFile</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>    </span><span class="annot"><a href="SafeRm.Runner.Env.html#%24sel%3Afinalizer%3AMkLogFile"><span class="hs-identifier">finalizer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-70"></span><span>    </span><span class="annot"><a href="SafeRm.Runner.Env.html#%24sel%3Ahandle%3AMkLogFile"><span class="hs-identifier">handle</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>    </span><span class="annot"><a href="SafeRm.Runner.Env.html#%24sel%3AlogEnv%3AMkEnv"><span class="hs-identifier">logEnv</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><a href="SafeRm.Runner.Env.html#%24sel%3AlogFile%3AMkLogEnv"><span class="hs-identifier">logFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-73"></span><span>    </span><span class="annot"><a href="SafeRm.Runner.Env.html#%24sel%3AlogLevel%3AMkLogFile"><span class="hs-identifier">logLevel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-74"></span><span>    </span><span class="annot"><a href="SafeRm.Runner.Env.html#%24sel%3AlogNamespace%3AMkLogEnv"><span class="hs-identifier">logNamespace</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SafeRm.Runner.SafeRmT.html"><span class="hs-identifier">SafeRm.Runner.SafeRmT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Runner.SafeRmT.html#runSafeRmT"><span class="hs-identifier">runSafeRmT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="SafeRm.Runner.Toml.html"><span class="hs-identifier">SafeRm.Runner.Toml</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Runner.Toml.html#TomlConfig"><span class="hs-identifier">TomlConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="SafeRm.Runner.Toml.html#mergeConfigs"><span class="hs-identifier">mergeConfigs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/djnxmjhpn66gm73mxnn95pzd1zyli6vv-toml-reader-0.1.0.0-doc/share/doc/toml-reader-0.1.0.0/html/src/TOML.html"><span class="hs-identifier">TOML</span></a></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/smv0bjih6fh6klcs4cwm4ak4dy74hvmn-unliftio-0.2.22.0-doc/share/doc/unliftio-0.2.22.0/html/src/UnliftIO.Directory.html"><span class="hs-identifier">UnliftIO.Directory</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/directory-1.3.6.2/src/System.Directory.Internal.Common.html#XdgDirectory"><span class="hs-identifier">XdgDirectory</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/directory-1.3.6.2/src/System.Directory.Internal.Common.html#XdgConfig"><span class="hs-identifier">XdgConfig</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="file:///nix/store/smv0bjih6fh6klcs4cwm4ak4dy74hvmn-unliftio-0.2.22.0-doc/share/doc/unliftio-0.2.22.0/html/src/UnliftIO.Directory.html"><span class="hs-identifier">UnliftIO.Directory</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Dir</span></span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span class="hs-comment">-- | Entry point for running SafeRm. Does everything: reads CLI args,</span><span>
</span><span id="line-83"></span><span class="hs-comment">-- optional Toml config, and creates the environment before running</span><span>
</span><span id="line-84"></span><span class="hs-comment">-- SafeRm.</span><span>
</span><span id="line-85"></span><span class="hs-comment">--</span><span>
</span><span id="line-86"></span><span class="hs-comment">-- @since 0.1</span><span>
</span><span id="line-87"></span><span id="local-6989586621679300849"><span class="annot"><a href="SafeRm.Runner.html#runSafeRm"><span class="hs-identifier hs-type">runSafeRm</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="SafeRm.Effects.MonadFsReader.html#MonadFsReader"><span class="hs-identifier hs-type">MonadFsReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300849"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-89"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadFsWriter.html#MonadFsWriter"><span class="hs-identifier hs-type">MonadFsWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300849"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>    </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-91"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadCallStack.html#MonadCallStack"><span class="hs-identifier hs-type">MonadCallStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300849"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><a href="file:///nix/store/bxq9j5gs109r9hsk1856fwbn5zhqzn69-unliftio-core-0.2.0.1-doc/share/doc/unliftio-core-0.2.0.1/html/src/Control.Monad.IO.Unlift.html#MonadUnliftIO"><span class="hs-identifier hs-type">MonadUnliftIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300849"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadTerminal.html#MonadTerminal"><span class="hs-identifier hs-type">MonadTerminal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300849"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadSystemTime.html#MonadSystemTime"><span class="hs-identifier hs-type">MonadSystemTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300849"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><a href="#local-6989586621679300849"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span><span>
</span><span id="line-97"></span><span id="runSafeRm"><span class="annot"><span class="annottext">runSafeRm :: forall (m :: * -&gt; *).
(MonadFsReader m, MonadFsWriter m, HasCallStack, MonadCallStack m,
 MonadUnliftIO m, MonadTerminal m, MonadSystemTime m) =&gt;
m ()
</span><a href="SafeRm.Runner.html#runSafeRm"><span class="hs-identifier hs-var hs-var">runSafeRm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679300420"><span class="annot"><span class="annottext">TomlConfig
</span><a href="#local-6989586621679300420"><span class="hs-identifier hs-var">config</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679300419"><span class="annot"><span class="annottext">Command
</span><a href="#local-6989586621679300419"><span class="hs-identifier hs-var">cmd</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(HasCallStack, MonadFsReader m, MonadCallStack m,
 MonadUnliftIO m) =&gt;
m (TomlConfig, Command)
</span><a href="SafeRm.Runner.html#getConfiguration"><span class="hs-identifier hs-var">getConfiguration</span></a></span><span>
</span><span id="line-99"></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-comment">-- NOTE: Using setUncaughtExceptionHandler means we do not have to manually</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-comment">-- catch exceptions and print ourselves, just to get nicer output from</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-comment">-- show.</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679300791"><span class="annot"><a href="#local-6989586621679300418"><span class="hs-identifier hs-type">handleFn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Exception.Type.html#Exception"><span class="hs-identifier hs-type">Exception</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300791"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679300791"><span class="hs-identifier hs-type">e</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span></span><span>
</span><span id="line-104"></span><span>      </span><span id="local-6989586621679300418"><span class="annot"><span class="annottext">handleFn :: forall e. Exception e =&gt; e -&gt; Text
</span><a href="#local-6989586621679300418"><span class="hs-identifier hs-var hs-var">handleFn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall e. Exception e =&gt; Bool -&gt; e -&gt; Text
</span><a href="SafeRm.Exception.html#displayTraceIf"><span class="hs-identifier hs-var">displayTraceIf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TomlConfig
</span><a href="#local-6989586621679300420"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><a href="file:///nix/store/94qmscanawfjn5y0aw91l6n4ji9wcyrb-optics-core-0.4.1-doc/share/doc/optics-core-0.4.1/html/src/Optics.Operators.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;showTrace&quot; a =&gt; a
</span><span class="">#showTrace</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(SomeException -&gt; IO ()) -&gt; IO ()
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Conc.Sync.html#setUncaughtExceptionHandler"><span class="hs-identifier hs-var">setUncaughtExceptionHandler</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(HasCallStack, MonadTerminal m) =&gt;
Text -&gt; m ()
</span><a href="SafeRm.Effects.MonadTerminal.html#putTextLn"><span class="hs-identifier hs-var">putTextLn</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall e. Exception e =&gt; e -&gt; Text
</span><a href="#local-6989586621679300418"><span class="hs-identifier hs-var">handleFn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
MonadUnliftIO m =&gt;
m a -&gt; (a -&gt; m b) -&gt; (a -&gt; m c) -&gt; m c
</span><a href="file:///nix/store/smv0bjih6fh6klcs4cwm4ak4dy74hvmn-unliftio-0.2.22.0-doc/share/doc/unliftio-0.2.22.0/html/src/UnliftIO.Exception.html#bracket"><span class="hs-identifier hs-var">bracket</span></a></span><span>
</span><span id="line-108"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(HasCallStack, MonadCallStack m, MonadFsWriter m,
 MonadUnliftIO m) =&gt;
TomlConfig -&gt; m Env
</span><a href="SafeRm.Runner.html#configToEnv"><span class="hs-identifier hs-var">configToEnv</span></a></span><span> </span><span class="annot"><span class="annottext">TomlConfig
</span><a href="#local-6989586621679300420"><span class="hs-identifier hs-var">config</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>    </span><span class="annot"><span class="annottext">forall {k} {l} {k} {k'} {l} {k} {u} {v} {s} {u} {v} {m :: * -&gt; *}.
(JoinKinds k l k, JoinKinds k' l k, JoinKinds k A_Prism k',
 Is k An_AffineFold, LabelOptic &quot;finalizer&quot; l u v (IO ()) (IO ()),
 LabelOptic &quot;logEnv&quot; k s s u v,
 LabelOptic &quot;logFile&quot; l u v (Maybe u) (Maybe v), MonadIO m) =&gt;
s -&gt; m ()
</span><a href="#local-6989586621679300399"><span class="hs-identifier hs-var">closeLogging</span></a></span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall env (m :: * -&gt; *) a. SafeRmT env m a -&gt; env -&gt; m a
</span><a href="SafeRm.Runner.SafeRmT.html#runSafeRmT"><span class="hs-identifier hs-var">runSafeRmT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) env.
(MonadFsReader m, MonadFsWriter m, HasCallStack, HasTrashHome env,
 MonadLoggerContext m, MonadCallStack m, MonadReader env m,
 MonadUnliftIO m, MonadTerminal m, MonadSystemTime m) =&gt;
Command -&gt; m ()
</span><a href="SafeRm.Runner.html#runCmd"><span class="hs-identifier hs-var">runCmd</span></a></span><span> </span><span class="annot"><span class="annottext">Command
</span><a href="#local-6989586621679300419"><span class="hs-identifier hs-var">cmd</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-112"></span><span>    </span><span id="local-6989586621679300399"><span class="annot"><span class="annottext">closeLogging :: s -&gt; m ()
</span><a href="#local-6989586621679300399"><span class="hs-identifier hs-var hs-var">closeLogging</span></a></span></span><span> </span><span id="local-6989586621679300365"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679300365"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-113"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679300364"><span class="annot"><span class="annottext">mFinalizer :: Maybe (IO ())
</span><a href="#local-6989586621679300364"><span class="hs-identifier hs-var hs-var">mFinalizer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679300365"><span class="hs-identifier hs-var">env</span></a></span><span> </span><span class="annot"><span class="annottext">forall k s (is :: IxList) a.
Is k An_AffineFold =&gt;
s -&gt; Optic' k is s a -&gt; Maybe a
</span><a href="file:///nix/store/94qmscanawfjn5y0aw91l6n4ji9wcyrb-optics-core-0.4.1-doc/share/doc/optics-core-0.4.1/html/src/Optics.Operators.html#%5E%3F"><span class="hs-operator hs-var">^?</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;logEnv&quot; a =&gt; a
</span><span class="">#logEnv</span></span><span> </span><span class="annot"><span class="annottext">forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><a href="file:///nix/store/94qmscanawfjn5y0aw91l6n4ji9wcyrb-optics-core-0.4.1-doc/share/doc/optics-core-0.4.1/html/src/Optics.Internal.Optic.html#%25"><span class="hs-operator hs-var">%</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;logFile&quot; a =&gt; a
</span><span class="">#logFile</span></span><span> </span><span class="annot"><span class="annottext">forall (is :: IxList) (js :: IxList) (ks :: IxList) k k' l m s t u
       v a b.
(AppendIndices is js ks, JoinKinds k A_Prism k',
 JoinKinds k' l m) =&gt;
Optic k is s t (Maybe u) (Maybe v)
-&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><a href="file:///nix/store/94qmscanawfjn5y0aw91l6n4ji9wcyrb-optics-core-0.4.1-doc/share/doc/optics-core-0.4.1/html/src/Data.Maybe.Optics.html#%25%3F"><span class="hs-operator hs-var">%?</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;finalizer&quot; a =&gt; a
</span><span class="">#finalizer</span></span><span>
</span><span id="line-114"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(HasCallStack, MonadCallStack m, MonadUnliftIO m) =&gt;
m a -&gt; m a
</span><a href="SafeRm.Exception.html#withStackTracing"><span class="hs-identifier hs-var">withStackTracing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a -&gt; a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Maybe.html#fromMaybe"><span class="hs-identifier hs-var">fromMaybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (IO ())
</span><a href="#local-6989586621679300364"><span class="hs-identifier hs-var">mFinalizer</span></a></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="hs-comment">-- | Runs SafeRm in the given environment. This is useful in conjunction with</span><span>
</span><span id="line-117"></span><span class="hs-comment">-- 'getConfiguration' as an alternative 'runSafeRm', when we want to use a</span><span>
</span><span id="line-118"></span><span class="hs-comment">-- custom env.</span><span>
</span><span id="line-119"></span><span id="local-6989586621679300735"><span id="local-6989586621679300736"><span class="annot"><a href="SafeRm.Runner.html#runCmd"><span class="hs-identifier hs-type">runCmd</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="SafeRm.Effects.MonadFsReader.html#MonadFsReader"><span class="hs-identifier hs-type">MonadFsReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300736"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-121"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadFsWriter.html#MonadFsWriter"><span class="hs-identifier hs-type">MonadFsWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300736"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-122"></span><span>    </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><a href="SafeRm.Env.html#HasTrashHome"><span class="hs-identifier hs-type">HasTrashHome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300735"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadLoggerContext.html#MonadLoggerContext"><span class="hs-identifier hs-type">MonadLoggerContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300736"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-125"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadCallStack.html#MonadCallStack"><span class="hs-identifier hs-type">MonadCallStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300736"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.Reader.Class.html#MonadReader"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300735"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300736"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-127"></span><span>    </span><span class="annot"><a href="file:///nix/store/bxq9j5gs109r9hsk1856fwbn5zhqzn69-unliftio-core-0.2.0.1-doc/share/doc/unliftio-core-0.2.0.1/html/src/Control.Monad.IO.Unlift.html#MonadUnliftIO"><span class="hs-identifier hs-type">MonadUnliftIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300736"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadTerminal.html#MonadTerminal"><span class="hs-identifier hs-type">MonadTerminal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300736"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-129"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadSystemTime.html#MonadSystemTime"><span class="hs-identifier hs-type">MonadSystemTime</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300736"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-131"></span><span>  </span><span class="annot"><a href="SafeRm.Runner.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><a href="#local-6989586621679300736"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-133"></span><span id="runCmd"><span class="annot"><span class="annottext">runCmd :: forall (m :: * -&gt; *) env.
(MonadFsReader m, MonadFsWriter m, HasCallStack, HasTrashHome env,
 MonadLoggerContext m, MonadCallStack m, MonadReader env m,
 MonadUnliftIO m, MonadTerminal m, MonadSystemTime m) =&gt;
Command -&gt; m ()
</span><a href="SafeRm.Runner.html#runCmd"><span class="hs-identifier hs-var hs-var">runCmd</span></a></span></span><span> </span><span id="local-6989586621679300340"><span class="annot"><span class="annottext">Command
</span><a href="#local-6989586621679300340"><span class="hs-identifier hs-var">cmd</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Command -&gt; m ()
</span><a href="#local-6989586621679300339"><span class="hs-identifier hs-var">runCmd'</span></a></span><span> </span><span class="annot"><span class="annottext">Command
</span><a href="#local-6989586621679300340"><span class="hs-identifier hs-var">cmd</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
MonadUnliftIO m =&gt;
m a -&gt; (SomeException -&gt; m a) -&gt; m a
</span><a href="file:///nix/store/smv0bjih6fh6klcs4cwm4ak4dy74hvmn-unliftio-0.2.22.0-doc/share/doc/unliftio-0.2.22.0/html/src/UnliftIO.Exception.html#catchAny"><span class="hs-operator hs-var">`catchAny`</span></a></span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {e} {b}.
(MonadLogger m, Exception e, MonadIO m) =&gt;
e -&gt; m b
</span><a href="#local-6989586621679300337"><span class="hs-identifier hs-var">logEx</span></a></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-135"></span><span>    </span><span id="local-6989586621679300339"><span class="annot"><span class="annottext">runCmd' :: Command -&gt; m ()
</span><a href="#local-6989586621679300339"><span class="hs-identifier hs-var hs-var">runCmd'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-136"></span><span>      </span><span class="annot"><a href="SafeRm.Runner.Command.html#Delete"><span class="hs-identifier hs-type">Delete</span></a></span><span> </span><span id="local-6989586621679300270"><span class="annot"><span class="annottext">UniqueSeq (PathI 'OriginalPath)
</span><a href="#local-6989586621679300270"><span class="hs-identifier hs-var">paths</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall env (m :: * -&gt; *).
(MonadFsReader m, MonadFsWriter m, HasCallStack, HasTrashHome env,
 MonadLoggerContext m, MonadCallStack m, MonadReader env m,
 MonadUnliftIO m, MonadSystemTime m) =&gt;
UniqueSeq (PathI 'OriginalPath) -&gt; m ()
</span><a href="SafeRm.html#delete"><span class="hs-identifier hs-var">SafeRm.delete</span></a></span><span> </span><span class="annot"><span class="annottext">UniqueSeq (PathI 'OriginalPath)
</span><a href="#local-6989586621679300270"><span class="hs-identifier hs-var">paths</span></a></span><span>
</span><span id="line-137"></span><span>      </span><span class="annot"><a href="SafeRm.Runner.Command.html#DeletePerm"><span class="hs-identifier hs-type">DeletePerm</span></a></span><span> </span><span id="local-6989586621679300268"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679300268"><span class="hs-identifier hs-var">force</span></a></span></span><span> </span><span id="local-6989586621679300267"><span class="annot"><span class="annottext">UniqueSeq (PathI 'TrashName)
</span><a href="#local-6989586621679300267"><span class="hs-identifier hs-var">paths</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall env (m :: * -&gt; *).
(MonadFsReader m, MonadFsWriter m, HasCallStack, HasTrashHome env,
 MonadLoggerContext m, MonadCallStack m, MonadReader env m,
 MonadUnliftIO m, MonadTerminal m) =&gt;
Bool -&gt; UniqueSeq (PathI 'TrashName) -&gt; m ()
</span><a href="SafeRm.html#deletePermanently"><span class="hs-identifier hs-var">SafeRm.deletePermanently</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679300268"><span class="hs-identifier hs-var">force</span></a></span><span> </span><span class="annot"><span class="annottext">UniqueSeq (PathI 'TrashName)
</span><a href="#local-6989586621679300267"><span class="hs-identifier hs-var">paths</span></a></span><span>
</span><span id="line-138"></span><span>      </span><span class="annot"><a href="SafeRm.Runner.Command.html#Empty"><span class="hs-identifier hs-type">Empty</span></a></span><span> </span><span id="local-6989586621679300265"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679300265"><span class="hs-identifier hs-var">force</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall env (m :: * -&gt; *).
(MonadFsReader m, MonadFsWriter m, HasCallStack, HasTrashHome env,
 MonadLoggerContext m, MonadIO m, MonadReader env m,
 MonadTerminal m) =&gt;
Bool -&gt; m ()
</span><a href="SafeRm.html#emptyTrash"><span class="hs-identifier hs-var">SafeRm.emptyTrash</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679300265"><span class="hs-identifier hs-var">force</span></a></span><span>
</span><span id="line-139"></span><span>      </span><span class="annot"><a href="SafeRm.Runner.Command.html#Restore"><span class="hs-identifier hs-type">Restore</span></a></span><span> </span><span id="local-6989586621679300263"><span class="annot"><span class="annottext">UniqueSeq (PathI 'TrashName)
</span><a href="#local-6989586621679300263"><span class="hs-identifier hs-var">paths</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall env (m :: * -&gt; *).
(MonadFsReader m, MonadFsWriter m, HasCallStack, HasTrashHome env,
 MonadLoggerContext m, MonadCallStack m, MonadReader env m,
 MonadUnliftIO m) =&gt;
UniqueSeq (PathI 'TrashName) -&gt; m ()
</span><a href="SafeRm.html#restore"><span class="hs-identifier hs-var">SafeRm.restore</span></a></span><span> </span><span class="annot"><span class="annottext">UniqueSeq (PathI 'TrashName)
</span><a href="#local-6989586621679300263"><span class="hs-identifier hs-var">paths</span></a></span><span>
</span><span id="line-140"></span><span>      </span><span class="annot"><span class="annottext">Command
</span><a href="SafeRm.Runner.Command.html#List"><span class="hs-identifier hs-var">List</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) env.
(MonadFsReader m, HasCallStack, HasTrashHome env,
 MonadLoggerContext m, MonadCallStack m, MonadIO m,
 MonadReader env m, MonadTerminal m) =&gt;
m ()
</span><a href="SafeRm.Runner.html#printIndex"><span class="hs-identifier hs-var">printIndex</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f a -&gt; f b -&gt; f b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%2A%3E"><span class="hs-operator hs-var">*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) env.
(MonadFsReader m, HasCallStack, HasTrashHome env,
 MonadLoggerContext m, MonadCallStack m, MonadIO m,
 MonadReader env m, MonadTerminal m) =&gt;
m ()
</span><a href="SafeRm.Runner.html#printMetadata"><span class="hs-identifier hs-var">printMetadata</span></a></span><span>
</span><span id="line-141"></span><span>      </span><span class="annot"><span class="annottext">Command
</span><a href="SafeRm.Runner.Command.html#Metadata"><span class="hs-identifier hs-var">Metadata</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) env.
(MonadFsReader m, HasCallStack, HasTrashHome env,
 MonadLoggerContext m, MonadCallStack m, MonadIO m,
 MonadReader env m, MonadTerminal m) =&gt;
m ()
</span><a href="SafeRm.Runner.html#printMetadata"><span class="hs-identifier hs-var">printMetadata</span></a></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span>    </span><span id="local-6989586621679300337"><span class="annot"><span class="annottext">logEx :: e -&gt; m b
</span><a href="#local-6989586621679300337"><span class="hs-identifier hs-var hs-var">logEx</span></a></span></span><span> </span><span id="local-6989586621679300247"><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679300247"><span class="hs-identifier hs-var">ex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-144"></span><span>      </span><span class="hs-special">$</span><span class="hs-special">(</span><span class="hs-identifier">logError</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall e. Exception e =&gt; e -&gt; Text
</span><a href="SafeRm.Exception.html#displayTrace"><span class="hs-identifier hs-var">displayTrace</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679300247"><span class="hs-identifier hs-var">ex</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>      </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e a. (MonadIO m, Exception e) =&gt; e -&gt; m a
</span><a href="file:///nix/store/smv0bjih6fh6klcs4cwm4ak4dy74hvmn-unliftio-0.2.22.0-doc/share/doc/unliftio-0.2.22.0/html/src/UnliftIO.Exception.html#throwIO"><span class="hs-identifier hs-var">throwIO</span></a></span><span> </span><span class="annot"><span class="annottext">e
</span><a href="#local-6989586621679300247"><span class="hs-identifier hs-var">ex</span></a></span><span>
</span><span id="line-146"></span><span>
</span><span id="line-147"></span><span class="hs-comment">-- | Parses CLI 'Args' and optional 'TomlConfig' to produce the final Env used</span><span>
</span><span id="line-148"></span><span class="hs-comment">-- by SafeRm.</span><span>
</span><span id="line-149"></span><span class="hs-comment">--</span><span>
</span><span id="line-150"></span><span class="hs-comment">-- @since 0.1</span><span>
</span><span id="line-151"></span><span id="local-6989586621679300663"><span class="annot"><a href="SafeRm.Runner.html#getEnv"><span class="hs-identifier hs-type">getEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-152"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadFsReader.html#MonadFsReader"><span class="hs-identifier hs-type">MonadFsReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300663"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadFsWriter.html#MonadFsWriter"><span class="hs-identifier hs-type">MonadFsWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300663"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadCallStack.html#MonadCallStack"><span class="hs-identifier hs-type">MonadCallStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300663"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><a href="file:///nix/store/bxq9j5gs109r9hsk1856fwbn5zhqzn69-unliftio-core-0.2.0.1-doc/share/doc/unliftio-core-0.2.0.1/html/src/Control.Monad.IO.Unlift.html#MonadUnliftIO"><span class="hs-identifier hs-type">MonadUnliftIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300663"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><a href="#local-6989586621679300663"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Runner.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="SafeRm.Runner.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-159"></span><span id="getEnv"><span class="annot"><span class="annottext">getEnv :: forall (m :: * -&gt; *).
(HasCallStack, MonadFsReader m, MonadFsWriter m, MonadCallStack m,
 MonadUnliftIO m) =&gt;
m (Env, Command)
</span><a href="SafeRm.Runner.html#getEnv"><span class="hs-identifier hs-var hs-var">getEnv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-160"></span><span>  </span><span class="hs-special">(</span><span id="local-6989586621679300172"><span class="annot"><span class="annottext">TomlConfig
</span><a href="#local-6989586621679300172"><span class="hs-identifier hs-var">mergedConfig</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679300171"><span class="annot"><span class="annottext">Command
</span><a href="#local-6989586621679300171"><span class="hs-identifier hs-var">command</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(HasCallStack, MonadFsReader m, MonadCallStack m,
 MonadUnliftIO m) =&gt;
m (TomlConfig, Command)
</span><a href="SafeRm.Runner.html#getConfiguration"><span class="hs-identifier hs-var">getConfiguration</span></a></span><span>
</span><span id="line-161"></span><span>
</span><span id="line-162"></span><span>  </span><span id="local-6989586621679300170"><span class="annot"><span class="annottext">PathI 'TrashHome
</span><a href="#local-6989586621679300170"><span class="hs-identifier hs-var">trashHome</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(HasCallStack, MonadCallStack m, MonadUnliftIO m) =&gt;
Maybe (PathI 'TrashHome) -&gt; m (PathI 'TrashHome)
</span><a href="SafeRm.Runner.html#trashOrDefault"><span class="hs-identifier hs-var">trashOrDefault</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TomlConfig
</span><a href="#local-6989586621679300172"><span class="hs-identifier hs-var">mergedConfig</span></a></span><span> </span><span class="annot"><span class="annottext">forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><a href="file:///nix/store/94qmscanawfjn5y0aw91l6n4ji9wcyrb-optics-core-0.4.1-doc/share/doc/optics-core-0.4.1/html/src/Optics.Operators.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;trashHome&quot; a =&gt; a
</span><span class="">#trashHome</span></span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-comment">-- NOTE: Needed so below openFile command does not fail</span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><span class="annottext">forall a (i :: PathIndex).
HasCallStack =&gt;
(HasCallStack =&gt; String -&gt; a) -&gt; PathI i -&gt; a
</span><a href="SafeRm.Data.Paths.html#applyPathI"><span class="hs-identifier hs-var">Paths.applyPathI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadFsWriter m, HasCallStack) =&gt;
Bool -&gt; String -&gt; m ()
</span><a href="SafeRm.Effects.MonadFsWriter.html#createDirectoryIfMissing"><span class="hs-identifier hs-var">createDirectoryIfMissing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PathI 'TrashHome
</span><a href="#local-6989586621679300170"><span class="hs-identifier hs-var">trashHome</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>  </span><span id="local-6989586621679300163"><span class="annot"><span class="annottext">Maybe LogFile
</span><a href="#local-6989586621679300163"><span class="hs-identifier hs-var">logFile</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#join"><span class="hs-identifier hs-var">join</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TomlConfig
</span><a href="#local-6989586621679300172"><span class="hs-identifier hs-var">mergedConfig</span></a></span><span> </span><span class="annot"><span class="annottext">forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><a href="file:///nix/store/94qmscanawfjn5y0aw91l6n4ji9wcyrb-optics-core-0.4.1-doc/share/doc/optics-core-0.4.1/html/src/Optics.Operators.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;logLevel&quot; a =&gt; a
</span><span class="">#logLevel</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="annottext">Maybe LogLevel
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679300162"><span class="annot"><span class="annottext">LogLevel
</span><a href="#local-6989586621679300162"><span class="hs-identifier hs-var">lvl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-169"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679300161"><span class="annot"><span class="annottext">logPath :: String
</span><a href="#local-6989586621679300161"><span class="hs-identifier hs-var hs-var">logPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PathI 'TrashHome
</span><a href="#local-6989586621679300170"><span class="hs-identifier hs-var">trashHome</span></a></span><span> </span><span class="annot"><span class="annottext">forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><a href="file:///nix/store/94qmscanawfjn5y0aw91l6n4ji9wcyrb-optics-core-0.4.1-doc/share/doc/optics-core-0.4.1/html/src/Optics.Operators.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;unPathI&quot; a =&gt; a
</span><span class="">#unPathI</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/filepath-1.4.2.2/src/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.log&quot;</span></span><span>
</span><span id="line-170"></span><span>      </span><span id="local-6989586621679300159"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679300159"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(HasCallStack, MonadCallStack m, MonadUnliftIO m) =&gt;
m a -&gt; m a
</span><a href="SafeRm.Exception.html#withStackTracing"><span class="hs-identifier hs-var">withStackTracing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadFsWriter m =&gt;
String -&gt; IOMode -&gt; m Handle
</span><a href="SafeRm.Effects.MonadFsWriter.html#openFile"><span class="hs-identifier hs-var">openFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679300161"><span class="hs-identifier hs-var">logPath</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.IO.IOMode.html#AppendMode"><span class="hs-identifier hs-var">AppendMode</span></a></span><span>
</span><span id="line-171"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-172"></span><span>        </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-173"></span><span>          </span><span class="annot"><a href="SafeRm.Runner.Env.html#MkLogFile"><span class="hs-identifier hs-type">MkLogFile</span></a></span><span>
</span><span id="line-174"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:handle:MkLogFile :: Handle
</span><a href="SafeRm.Runner.Env.html#%24sel%3Ahandle%3AMkLogFile"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679300159"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-175"></span><span>              </span><span class="annot"><span class="annottext">$sel:logLevel:MkLogFile :: LogLevel
</span><a href="SafeRm.Runner.Env.html#%24sel%3AlogLevel%3AMkLogFile"><span class="hs-identifier hs-var">logLevel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="#local-6989586621679300162"><span class="hs-identifier hs-var">lvl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-176"></span><span>              </span><span class="annot"><span class="annottext">$sel:finalizer:MkLogFile :: IO ()
</span><a href="SafeRm.Runner.Env.html#%24sel%3Afinalizer%3AMkLogFile"><span class="hs-identifier hs-var">finalizer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFsWriter m =&gt; Handle -&gt; m ()
</span><a href="SafeRm.Effects.MonadFsWriter.html#hFlush"><span class="hs-identifier hs-var">hFlush</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679300159"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. MonadUnliftIO m =&gt; m a -&gt; m b -&gt; m a
</span><a href="file:///nix/store/smv0bjih6fh6klcs4cwm4ak4dy74hvmn-unliftio-0.2.22.0-doc/share/doc/unliftio-0.2.22.0/html/src/UnliftIO.Exception.html#finally"><span class="hs-operator hs-var">`finally`</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFsWriter m =&gt; Handle -&gt; m ()
</span><a href="SafeRm.Effects.MonadFsWriter.html#hClose"><span class="hs-identifier hs-var">hClose</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679300159"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-177"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-178"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679300156"><span class="annot"><span class="annottext">env :: Env
</span><a href="#local-6989586621679300156"><span class="hs-identifier hs-var hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-179"></span><span>        </span><span class="annot"><a href="SafeRm.Runner.Env.html#MkEnv"><span class="hs-identifier hs-type">MkEnv</span></a></span><span>
</span><span id="line-180"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">PathI 'TrashHome
trashHome :: PathI 'TrashHome
$sel:trashHome:MkEnv :: PathI 'TrashHome
</span><a href="#local-6989586621679300170"><span class="hs-identifier hs-var hs-var">trashHome</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-181"></span><span>            </span><span class="annot"><span class="annottext">$sel:logEnv:MkEnv :: LogEnv
</span><a href="SafeRm.Runner.Env.html#%24sel%3AlogEnv%3AMkEnv"><span class="hs-identifier hs-var">logEnv</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-182"></span><span>              </span><span class="annot"><a href="SafeRm.Runner.Env.html#MkLogEnv"><span class="hs-identifier hs-type">MkLogEnv</span></a></span><span>
</span><span id="line-183"></span><span>                </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Maybe LogFile
logFile :: Maybe LogFile
$sel:logFile:MkLogEnv :: Maybe LogFile
</span><a href="#local-6989586621679300163"><span class="hs-identifier hs-var hs-var">logFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-184"></span><span>                  </span><span class="annot"><span class="annottext">$sel:logNamespace:MkLogEnv :: Namespace
</span><a href="SafeRm.Runner.Env.html#%24sel%3AlogNamespace%3AMkLogEnv"><span class="hs-identifier hs-var">logNamespace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Namespace
</span><span class="hs-string">&quot;runner&quot;</span></span><span>
</span><span id="line-185"></span><span>                </span><span class="hs-special">}</span><span>
</span><span id="line-186"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Env
</span><a href="#local-6989586621679300156"><span class="hs-identifier hs-var">env</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Command
</span><a href="#local-6989586621679300171"><span class="hs-identifier hs-var">command</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>
</span><span id="line-189"></span><span id="local-6989586621679300752"><span class="annot"><a href="SafeRm.Runner.html#configToEnv"><span class="hs-identifier hs-type">configToEnv</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-190"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-191"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadCallStack.html#MonadCallStack"><span class="hs-identifier hs-type">MonadCallStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300752"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadFsWriter.html#MonadFsWriter"><span class="hs-identifier hs-type">MonadFsWriter</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300752"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><a href="file:///nix/store/bxq9j5gs109r9hsk1856fwbn5zhqzn69-unliftio-core-0.2.0.1-doc/share/doc/unliftio-core-0.2.0.1/html/src/Control.Monad.IO.Unlift.html#MonadUnliftIO"><span class="hs-identifier hs-type">MonadUnliftIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300752"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-194"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-195"></span><span>  </span><span class="annot"><a href="SafeRm.Runner.Toml.html#TomlConfig"><span class="hs-identifier hs-type">TomlConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-196"></span><span>  </span><span class="annot"><a href="#local-6989586621679300752"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="SafeRm.Runner.Env.html#Env"><span class="hs-identifier hs-type">Env</span></a></span></span><span>
</span><span id="line-197"></span><span id="configToEnv"><span class="annot"><span class="annottext">configToEnv :: forall (m :: * -&gt; *).
(HasCallStack, MonadCallStack m, MonadFsWriter m,
 MonadUnliftIO m) =&gt;
TomlConfig -&gt; m Env
</span><a href="SafeRm.Runner.html#configToEnv"><span class="hs-identifier hs-var hs-var">configToEnv</span></a></span></span><span> </span><span id="local-6989586621679300102"><span class="annot"><span class="annottext">TomlConfig
</span><a href="#local-6989586621679300102"><span class="hs-identifier hs-var">mergedConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-198"></span><span>  </span><span id="local-6989586621679300101"><span class="annot"><span class="annottext">PathI 'TrashHome
</span><a href="#local-6989586621679300101"><span class="hs-identifier hs-var">trashHome</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(HasCallStack, MonadCallStack m, MonadUnliftIO m) =&gt;
Maybe (PathI 'TrashHome) -&gt; m (PathI 'TrashHome)
</span><a href="SafeRm.Runner.html#trashOrDefault"><span class="hs-identifier hs-var">trashOrDefault</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TomlConfig
</span><a href="#local-6989586621679300102"><span class="hs-identifier hs-var">mergedConfig</span></a></span><span> </span><span class="annot"><span class="annottext">forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><a href="file:///nix/store/94qmscanawfjn5y0aw91l6n4ji9wcyrb-optics-core-0.4.1-doc/share/doc/optics-core-0.4.1/html/src/Optics.Operators.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;trashHome&quot; a =&gt; a
</span><span class="">#trashHome</span></span><span>
</span><span id="line-199"></span><span>  </span><span class="hs-comment">-- NOTE: Needed so below openFile command does not fail</span><span>
</span><span id="line-200"></span><span>  </span><span class="annot"><span class="annottext">forall a (i :: PathIndex).
HasCallStack =&gt;
(HasCallStack =&gt; String -&gt; a) -&gt; PathI i -&gt; a
</span><a href="SafeRm.Data.Paths.html#applyPathI"><span class="hs-identifier hs-var">Paths.applyPathI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadFsWriter m, HasCallStack) =&gt;
Bool -&gt; String -&gt; m ()
</span><a href="SafeRm.Effects.MonadFsWriter.html#createDirectoryIfMissing"><span class="hs-identifier hs-var">createDirectoryIfMissing</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/ghc-prim-0.8.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">PathI 'TrashHome
</span><a href="#local-6989586621679300101"><span class="hs-identifier hs-var">trashHome</span></a></span><span>
</span><span id="line-201"></span><span>
</span><span id="line-202"></span><span>  </span><span id="local-6989586621679300096"><span class="annot"><span class="annottext">Maybe LogFile
</span><a href="#local-6989586621679300096"><span class="hs-identifier hs-var">logFile</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; m (m a) -&gt; m a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#join"><span class="hs-identifier hs-var">join</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TomlConfig
</span><a href="#local-6989586621679300102"><span class="hs-identifier hs-var">mergedConfig</span></a></span><span> </span><span class="annot"><span class="annottext">forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><a href="file:///nix/store/94qmscanawfjn5y0aw91l6n4ji9wcyrb-optics-core-0.4.1-doc/share/doc/optics-core-0.4.1/html/src/Optics.Operators.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;logLevel&quot; a =&gt; a
</span><span class="">#logLevel</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-203"></span><span>    </span><span class="annot"><span class="annottext">Maybe LogLevel
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-204"></span><span>    </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679300095"><span class="annot"><span class="annottext">LogLevel
</span><a href="#local-6989586621679300095"><span class="hs-identifier hs-var">lvl</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-205"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679300094"><span class="annot"><span class="annottext">logPath :: String
</span><a href="#local-6989586621679300094"><span class="hs-identifier hs-var hs-var">logPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PathI 'TrashHome
</span><a href="#local-6989586621679300101"><span class="hs-identifier hs-var">trashHome</span></a></span><span> </span><span class="annot"><span class="annottext">forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><a href="file:///nix/store/94qmscanawfjn5y0aw91l6n4ji9wcyrb-optics-core-0.4.1-doc/share/doc/optics-core-0.4.1/html/src/Optics.Operators.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;unPathI&quot; a =&gt; a
</span><span class="">#unPathI</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/filepath-1.4.2.2/src/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.log&quot;</span></span><span>
</span><span id="line-206"></span><span>      </span><span id="local-6989586621679300093"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679300093"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(HasCallStack, MonadCallStack m, MonadUnliftIO m) =&gt;
m a -&gt; m a
</span><a href="SafeRm.Exception.html#withStackTracing"><span class="hs-identifier hs-var">withStackTracing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadFsWriter m =&gt;
String -&gt; IOMode -&gt; m Handle
</span><a href="SafeRm.Effects.MonadFsWriter.html#openFile"><span class="hs-identifier hs-var">openFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679300094"><span class="hs-identifier hs-var">logPath</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.IO.IOMode.html#AppendMode"><span class="hs-identifier hs-var">AppendMode</span></a></span><span>
</span><span id="line-207"></span><span>      </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-208"></span><span>        </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-209"></span><span>          </span><span class="annot"><a href="SafeRm.Runner.Env.html#MkLogFile"><span class="hs-identifier hs-type">MkLogFile</span></a></span><span>
</span><span id="line-210"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:handle:MkLogFile :: Handle
</span><a href="SafeRm.Runner.Env.html#%24sel%3Ahandle%3AMkLogFile"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679300093"><span class="hs-identifier hs-var">h</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-211"></span><span>              </span><span class="annot"><span class="annottext">$sel:logLevel:MkLogFile :: LogLevel
</span><a href="SafeRm.Runner.Env.html#%24sel%3AlogLevel%3AMkLogFile"><span class="hs-identifier hs-var">logLevel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LogLevel
</span><a href="#local-6989586621679300095"><span class="hs-identifier hs-var">lvl</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-212"></span><span>              </span><span class="annot"><span class="annottext">$sel:finalizer:MkLogFile :: IO ()
</span><a href="SafeRm.Runner.Env.html#%24sel%3Afinalizer%3AMkLogFile"><span class="hs-identifier hs-var">finalizer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFsWriter m =&gt; Handle -&gt; m ()
</span><a href="SafeRm.Effects.MonadFsWriter.html#hFlush"><span class="hs-identifier hs-var">hFlush</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679300093"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. MonadUnliftIO m =&gt; m a -&gt; m b -&gt; m a
</span><a href="file:///nix/store/smv0bjih6fh6klcs4cwm4ak4dy74hvmn-unliftio-0.2.22.0-doc/share/doc/unliftio-0.2.22.0/html/src/UnliftIO.Exception.html#finally"><span class="hs-operator hs-var">`finally`</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadFsWriter m =&gt; Handle -&gt; m ()
</span><a href="SafeRm.Effects.MonadFsWriter.html#hClose"><span class="hs-identifier hs-var">hClose</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679300093"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-213"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-214"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-215"></span><span>    </span><span class="annot"><a href="SafeRm.Runner.Env.html#MkEnv"><span class="hs-identifier hs-type">MkEnv</span></a></span><span>
</span><span id="line-216"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">PathI 'TrashHome
trashHome :: PathI 'TrashHome
$sel:trashHome:MkEnv :: PathI 'TrashHome
</span><a href="#local-6989586621679300101"><span class="hs-identifier hs-var hs-var">trashHome</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-217"></span><span>        </span><span class="annot"><span class="annottext">$sel:logEnv:MkEnv :: LogEnv
</span><a href="SafeRm.Runner.Env.html#%24sel%3AlogEnv%3AMkEnv"><span class="hs-identifier hs-var">logEnv</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-218"></span><span>          </span><span class="annot"><a href="SafeRm.Runner.Env.html#MkLogEnv"><span class="hs-identifier hs-type">MkLogEnv</span></a></span><span>
</span><span id="line-219"></span><span>            </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">Maybe LogFile
logFile :: Maybe LogFile
$sel:logFile:MkLogEnv :: Maybe LogFile
</span><a href="#local-6989586621679300096"><span class="hs-identifier hs-var hs-var">logFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-220"></span><span>              </span><span class="annot"><span class="annottext">$sel:logNamespace:MkLogEnv :: Namespace
</span><a href="SafeRm.Runner.Env.html#%24sel%3AlogNamespace%3AMkLogEnv"><span class="hs-identifier hs-var">logNamespace</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Namespace
</span><span class="hs-string">&quot;runner&quot;</span></span><span>
</span><span id="line-221"></span><span>            </span><span class="hs-special">}</span><span>
</span><span id="line-222"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-223"></span><span>
</span><span id="line-224"></span><span class="hs-comment">-- | Parses CLI 'Args' and optional 'TomlConfig' to produce the user</span><span>
</span><span id="line-225"></span><span class="hs-comment">-- configuration. For values shared between the CLI and Toml file, the CLI</span><span>
</span><span id="line-226"></span><span class="hs-comment">-- takes priority.</span><span>
</span><span id="line-227"></span><span class="hs-comment">--</span><span>
</span><span id="line-228"></span><span class="hs-comment">-- For example, if both the CLI and Toml file specify the trash home, then</span><span>
</span><span id="line-229"></span><span class="hs-comment">-- the CLI's value will be used.</span><span>
</span><span id="line-230"></span><span class="hs-comment">--</span><span>
</span><span id="line-231"></span><span class="hs-comment">-- @since 0.1</span><span>
</span><span id="line-232"></span><span id="local-6989586621679300792"><span class="annot"><a href="SafeRm.Runner.html#getConfiguration"><span class="hs-identifier hs-type">getConfiguration</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadFsReader.html#MonadFsReader"><span class="hs-identifier hs-type">MonadFsReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300792"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-235"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadCallStack.html#MonadCallStack"><span class="hs-identifier hs-type">MonadCallStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300792"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-236"></span><span>    </span><span class="annot"><a href="file:///nix/store/bxq9j5gs109r9hsk1856fwbn5zhqzn69-unliftio-core-0.2.0.1-doc/share/doc/unliftio-core-0.2.0.1/html/src/Control.Monad.IO.Unlift.html#MonadUnliftIO"><span class="hs-identifier hs-type">MonadUnliftIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300792"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><a href="#local-6989586621679300792"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Runner.Toml.html#TomlConfig"><span class="hs-identifier hs-type">TomlConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="SafeRm.Runner.Command.html#Command"><span class="hs-identifier hs-type">Command</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-239"></span><span id="getConfiguration"><span class="annot"><span class="annottext">getConfiguration :: forall (m :: * -&gt; *).
(HasCallStack, MonadFsReader m, MonadCallStack m,
 MonadUnliftIO m) =&gt;
m (TomlConfig, Command)
</span><a href="SafeRm.Runner.html#getConfiguration"><span class="hs-identifier hs-var hs-var">getConfiguration</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-240"></span><span>  </span><span class="hs-comment">-- get CLI args</span><span>
</span><span id="line-241"></span><span>  </span><span id="local-6989586621679300039"><span class="annot"><span class="annottext">Args
</span><a href="#local-6989586621679300039"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadIO m =&gt; IO a -&gt; m a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Control.Monad.IO.Class.html#liftIO"><span class="hs-identifier hs-var">liftIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO Args
</span><a href="SafeRm.Runner.Args.html#getArgs"><span class="hs-identifier hs-var">getArgs</span></a></span><span>
</span><span id="line-242"></span><span>
</span><span id="line-243"></span><span>  </span><span class="hs-comment">-- get toml config</span><span>
</span><span id="line-244"></span><span>  </span><span id="local-6989586621679300038"><span class="annot"><span class="annottext">TomlConfig
</span><a href="#local-6989586621679300038"><span class="hs-identifier hs-var">tomlConfig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Args
</span><a href="#local-6989586621679300039"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><a href="file:///nix/store/94qmscanawfjn5y0aw91l6n4ji9wcyrb-optics-core-0.4.1-doc/share/doc/optics-core-0.4.1/html/src/Optics.Operators.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;tomlConfigPath&quot; a =&gt; a
</span><span class="">#tomlConfigPath</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-comment">-- 1. explicit toml config path given: read</span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><a href="SafeRm.Runner.Args.html#TomlPath"><span class="hs-identifier hs-type">TomlPath</span></a></span><span> </span><span id="local-6989586621679300037"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679300037"><span class="hs-identifier hs-var">tomlPath</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {b}.
(MonadFsReader m, MonadCallStack m, MonadIO m, DecodeTOML b) =&gt;
String -&gt; m b
</span><a href="#local-6989586621679300036"><span class="hs-identifier hs-var">readConfig</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679300037"><span class="hs-identifier hs-var">tomlPath</span></a></span><span>
</span><span id="line-247"></span><span>    </span><span class="hs-comment">-- no toml config path given...</span><span>
</span><span id="line-248"></span><span>    </span><span class="annot"><span class="annottext">TomlConfigPath
</span><a href="SafeRm.Runner.Args.html#TomlDefault"><span class="hs-identifier hs-var">TomlDefault</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-249"></span><span>      </span><span id="local-6989586621679300035"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679300035"><span class="hs-identifier hs-var">xdgConfig</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(HasCallStack, MonadCallStack m, MonadUnliftIO m) =&gt;
m a -&gt; m a
</span><a href="SafeRm.Exception.html#withStackTracing"><span class="hs-identifier hs-var">withStackTracing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
MonadIO m =&gt;
XdgDirectory -&gt; String -&gt; m String
</span><a href="file:///nix/store/smv0bjih6fh6klcs4cwm4ak4dy74hvmn-unliftio-0.2.22.0-doc/share/doc/unliftio-0.2.22.0/html/src/UnliftIO.Directory.html#getXdgDirectory"><span class="hs-identifier hs-var">Dir.getXdgDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">XdgDirectory
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/directory-1.3.6.2/src/System.Directory.Internal.Common.html#XdgConfig"><span class="hs-identifier hs-var">XdgConfig</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;safe-rm&quot;</span></span><span>
</span><span id="line-250"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679300033"><span class="annot"><span class="annottext">defPath :: String
</span><a href="#local-6989586621679300033"><span class="hs-identifier hs-var hs-var">defPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679300035"><span class="hs-identifier hs-var">xdgConfig</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/filepath-1.4.2.2/src/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;config.toml&quot;</span></span><span>
</span><span id="line-251"></span><span>      </span><span id="local-6989586621679300032"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679300032"><span class="hs-identifier hs-var">exists</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(HasCallStack, MonadCallStack m, MonadUnliftIO m) =&gt;
m a -&gt; m a
</span><a href="SafeRm.Exception.html#withStackTracing"><span class="hs-identifier hs-var">withStackTracing</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; m Bool
</span><a href="file:///nix/store/smv0bjih6fh6klcs4cwm4ak4dy74hvmn-unliftio-0.2.22.0-doc/share/doc/unliftio-0.2.22.0/html/src/UnliftIO.Directory.html#doesFileExist"><span class="hs-identifier hs-var">Dir.doesFileExist</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679300033"><span class="hs-identifier hs-var">defPath</span></a></span><span>
</span><span id="line-252"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679300032"><span class="hs-identifier hs-var">exists</span></a></span><span>
</span><span id="line-253"></span><span>        </span><span class="hs-keyword">then</span><span> </span><span class="hs-comment">-- 2. config exists at default path: read</span><span>
</span><span id="line-254"></span><span>          </span><span class="annot"><span class="annottext">forall {m :: * -&gt; *} {b}.
(MonadFsReader m, MonadCallStack m, MonadIO m, DecodeTOML b) =&gt;
String -&gt; m b
</span><a href="#local-6989586621679300036"><span class="hs-identifier hs-var">readConfig</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679300033"><span class="hs-identifier hs-var">defPath</span></a></span><span>
</span><span id="line-255"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-comment">-- 3. no config exists: return default (empty)</span><span>
</span><span id="line-256"></span><span>          </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-comment">-- 4. toml explicitly disabled</span><span>
</span><span id="line-258"></span><span>    </span><span class="annot"><span class="annottext">TomlConfigPath
</span><a href="SafeRm.Runner.Args.html#TomlNone"><span class="hs-identifier hs-var">TomlNone</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var">mempty</span></a></span><span>
</span><span id="line-259"></span><span>
</span><span id="line-260"></span><span>  </span><span class="hs-comment">-- merge share CLI and toml values</span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679300030"><span class="annot"><span class="annottext">mergedConfig :: TomlConfig
</span><a href="#local-6989586621679300030"><span class="hs-identifier hs-var hs-var">mergedConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Args -&gt; TomlConfig -&gt; TomlConfig
</span><a href="SafeRm.Runner.Toml.html#mergeConfigs"><span class="hs-identifier hs-var">mergeConfigs</span></a></span><span> </span><span class="annot"><span class="annottext">Args
</span><a href="#local-6989586621679300039"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">TomlConfig
</span><a href="#local-6989586621679300038"><span class="hs-identifier hs-var">tomlConfig</span></a></span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TomlConfig
</span><a href="#local-6989586621679300030"><span class="hs-identifier hs-var">mergedConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Args
</span><a href="#local-6989586621679300039"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><a href="file:///nix/store/94qmscanawfjn5y0aw91l6n4ji9wcyrb-optics-core-0.4.1-doc/share/doc/optics-core-0.4.1/html/src/Optics.Operators.html#%5E."><span class="hs-operator hs-var">^.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. IsLabel &quot;command&quot; a =&gt; a
</span><span class="">#command</span></span><span class="hs-special">)</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-264"></span><span>    </span><span id="local-6989586621679300036"><span class="annot"><span class="annottext">readConfig :: String -&gt; m b
</span><a href="#local-6989586621679300036"><span class="hs-identifier hs-var hs-var">readConfig</span></a></span></span><span> </span><span id="local-6989586621679300001"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679300001"><span class="hs-identifier hs-var">fp</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-265"></span><span>      </span><span id="local-6989586621679300000"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679300000"><span class="hs-identifier hs-var">contents</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-266"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(MonadFsReader m, HasCallStack) =&gt;
String -&gt; m ByteString
</span><a href="SafeRm.Effects.MonadFsReader.html#readFile"><span class="hs-identifier hs-var">readFile</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679300001"><span class="hs-identifier hs-var">fp</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679299999"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679299999"><span class="hs-identifier hs-var">contents'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-267"></span><span>          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either UnicodeException Text
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/text-1.2.5.0/src/Data.Text.Encoding.html#decodeUtf8%27"><span class="hs-identifier hs-var">TEnc.decodeUtf8'</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679299999"><span class="hs-identifier hs-var">contents'</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-268"></span><span>            </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679299997"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679299997"><span class="hs-identifier hs-var">txt</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679299997"><span class="hs-identifier hs-var">txt</span></a></span><span>
</span><span id="line-269"></span><span>            </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679299996"><span class="annot"><span class="annottext">UnicodeException
</span><a href="#local-6989586621679299996"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-270"></span><span>              </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e a.
(Exception e, HasCallStack, MonadCallStack m, MonadIO m) =&gt;
(CallStack -&gt; e) -&gt; m a
</span><a href="SafeRm.Effects.MonadCallStack.html#throwCallStack"><span class="hs-identifier hs-var">throwCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-271"></span><span>                </span><span class="annot"><span class="annottext">SomeException -&gt; CallStack -&gt; ArbitraryE
</span><a href="SafeRm.Exception.html#MkArbitraryE"><span class="hs-identifier hs-var">MkArbitraryE</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall e. Exception e =&gt; e -&gt; SomeException
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Exception.Type.html#toException"><span class="hs-identifier hs-var">toException</span></a></span><span> </span><span class="annot"><span class="annottext">UnicodeException
</span><a href="#local-6989586621679299996"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall a. DecodeTOML a =&gt; Text -&gt; Either TOMLError a
</span><a href="file:///nix/store/djnxmjhpn66gm73mxnn95pzd1zyli6vv-toml-reader-0.1.0.0-doc/share/doc/toml-reader-0.1.0.0/html/src/TOML.Decode.html#decode"><span class="hs-identifier hs-var">TOML.decode</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679300000"><span class="hs-identifier hs-var">contents</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-273"></span><span>        </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679299993"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679299993"><span class="hs-identifier hs-var">cfg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679299993"><span class="hs-identifier hs-var">cfg</span></a></span><span>
</span><span id="line-274"></span><span>        </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679299992"><span class="annot"><span class="annottext">TOMLError
</span><a href="#local-6989586621679299992"><span class="hs-identifier hs-var">tomlErr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) e a.
(Exception e, HasCallStack, MonadCallStack m, MonadIO m) =&gt;
(CallStack -&gt; e) -&gt; m a
</span><a href="SafeRm.Effects.MonadCallStack.html#throwCallStack"><span class="hs-identifier hs-var">throwCallStack</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TOMLError -&gt; CallStack -&gt; TomlDecodeE
</span><a href="SafeRm.Exception.html#MkTomlDecodeE"><span class="hs-identifier hs-var">MkTomlDecodeE</span></a></span><span> </span><span class="annot"><span class="annottext">TOMLError
</span><a href="#local-6989586621679299992"><span class="hs-identifier hs-var">tomlErr</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span id="local-6989586621679300676"><span id="local-6989586621679300677"><span class="annot"><a href="SafeRm.Runner.html#printIndex"><span class="hs-identifier hs-type">printIndex</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="SafeRm.Effects.MonadFsReader.html#MonadFsReader"><span class="hs-identifier hs-type">MonadFsReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300677"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-278"></span><span>    </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-279"></span><span>    </span><span class="annot"><a href="SafeRm.Env.html#HasTrashHome"><span class="hs-identifier hs-type">HasTrashHome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300676"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-280"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadLoggerContext.html#MonadLoggerContext"><span class="hs-identifier hs-type">MonadLoggerContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300677"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadCallStack.html#MonadCallStack"><span class="hs-identifier hs-type">MonadCallStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300677"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-282"></span><span>    </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300677"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-283"></span><span>    </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.Reader.Class.html#MonadReader"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300676"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300677"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-284"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadTerminal.html#MonadTerminal"><span class="hs-identifier hs-type">MonadTerminal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300677"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-285"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-286"></span><span>  </span><span class="annot"><a href="#local-6989586621679300677"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-287"></span><span id="printIndex"><span class="annot"><span class="annottext">printIndex :: forall (m :: * -&gt; *) env.
(MonadFsReader m, HasCallStack, HasTrashHome env,
 MonadLoggerContext m, MonadCallStack m, MonadIO m,
 MonadReader env m, MonadTerminal m) =&gt;
m ()
</span><a href="SafeRm.Runner.html#printIndex"><span class="hs-identifier hs-var hs-var">printIndex</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall env (m :: * -&gt; *).
(MonadFsReader m, HasCallStack, HasTrashHome env,
 MonadLoggerContext m, MonadCallStack m, MonadIO m,
 MonadReader env m) =&gt;
m Index
</span><a href="SafeRm.html#getIndex"><span class="hs-identifier hs-var">SafeRm.getIndex</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(HasCallStack, Pretty a, MonadTerminal m) =&gt;
a -&gt; m ()
</span><a href="SafeRm.Runner.html#prettyDel"><span class="hs-identifier hs-var">prettyDel</span></a></span><span>
</span><span id="line-288"></span><span>
</span><span id="line-289"></span><span id="local-6989586621679299965"><span id="local-6989586621679299966"><span class="annot"><a href="SafeRm.Runner.html#printMetadata"><span class="hs-identifier hs-type">printMetadata</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="SafeRm.Effects.MonadFsReader.html#MonadFsReader"><span class="hs-identifier hs-type">MonadFsReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679299966"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-291"></span><span>    </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-292"></span><span>    </span><span class="annot"><a href="SafeRm.Env.html#HasTrashHome"><span class="hs-identifier hs-type">HasTrashHome</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679299965"><span class="hs-identifier hs-type">env</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-293"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadLoggerContext.html#MonadLoggerContext"><span class="hs-identifier hs-type">MonadLoggerContext</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679299966"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadCallStack.html#MonadCallStack"><span class="hs-identifier hs-type">MonadCallStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679299966"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-295"></span><span>    </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Control.Monad.IO.Class.html#MonadIO"><span class="hs-identifier hs-type">MonadIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679299966"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-296"></span><span>    </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/mtl-2.2.2/src/Control.Monad.Reader.Class.html#MonadReader"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679299965"><span class="hs-identifier hs-type">env</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679299966"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-297"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadTerminal.html#MonadTerminal"><span class="hs-identifier hs-type">MonadTerminal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679299966"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-298"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-299"></span><span>  </span><span class="annot"><a href="#local-6989586621679299966"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-300"></span><span id="printMetadata"><span class="annot"><span class="annottext">printMetadata :: forall (m :: * -&gt; *) env.
(MonadFsReader m, HasCallStack, HasTrashHome env,
 MonadLoggerContext m, MonadCallStack m, MonadIO m,
 MonadReader env m, MonadTerminal m) =&gt;
m ()
</span><a href="SafeRm.Runner.html#printMetadata"><span class="hs-identifier hs-var hs-var">printMetadata</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall env (m :: * -&gt; *).
(MonadFsReader m, HasCallStack, HasTrashHome env,
 MonadLoggerContext m, MonadCallStack m, MonadIO m,
 MonadReader env m) =&gt;
m Metadata
</span><a href="SafeRm.html#getMetadata"><span class="hs-identifier hs-var">SafeRm.getMetadata</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *).
(HasCallStack, Pretty a, MonadTerminal m) =&gt;
a -&gt; m ()
</span><a href="SafeRm.Runner.html#prettyDel"><span class="hs-identifier hs-var">prettyDel</span></a></span><span>
</span><span id="line-301"></span><span>
</span><span id="line-302"></span><span id="local-6989586621679300565"><span id="local-6989586621679300566"><span class="annot"><a href="SafeRm.Runner.html#prettyDel"><span class="hs-identifier hs-type">prettyDel</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="file:///nix/store/6c1i8y2d7sys43mjniwg2z8d4n3l61k3-prettyprinter-1.7.1-doc/share/doc/prettyprinter-1.7.1/html/src/Prettyprinter.Internal.html#Pretty"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300566"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="SafeRm.Effects.MonadTerminal.html#MonadTerminal"><span class="hs-identifier hs-type">MonadTerminal</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300565"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679300566"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679300565"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-303"></span><span id="prettyDel"><span class="annot"><span class="annottext">prettyDel :: forall a (m :: * -&gt; *).
(HasCallStack, Pretty a, MonadTerminal m) =&gt;
a -&gt; m ()
</span><a href="SafeRm.Runner.html#prettyDel"><span class="hs-identifier hs-var hs-var">prettyDel</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-304"></span><span>  </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(HasCallStack, MonadTerminal m) =&gt;
Text -&gt; m ()
</span><a href="SafeRm.Effects.MonadTerminal.html#putTextLn"><span class="hs-identifier hs-var">putTextLn</span></a></span><span>
</span><span id="line-305"></span><span>    </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. SimpleDocStream ann -&gt; Text
</span><a href="file:///nix/store/6c1i8y2d7sys43mjniwg2z8d4n3l61k3-prettyprinter-1.7.1-doc/share/doc/prettyprinter-1.7.1/html/src/Prettyprinter.Render.Text.html#renderStrict"><span class="hs-identifier hs-var">renderStrict</span></a></span><span>
</span><span id="line-306"></span><span>    </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann1 ann2. Doc ann1 -&gt; SimpleDocStream ann2
</span><a href="file:///nix/store/6c1i8y2d7sys43mjniwg2z8d4n3l61k3-prettyprinter-1.7.1-doc/share/doc/prettyprinter-1.7.1/html/src/Prettyprinter.Internal.html#layoutCompact"><span class="hs-identifier hs-var">layoutCompact</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="file:///nix/store/6c1i8y2d7sys43mjniwg2z8d4n3l61k3-prettyprinter-1.7.1-doc/share/doc/prettyprinter-1.7.1/html/src/Prettyprinter.Internal.html#pretty"><span class="hs-identifier hs-var">pretty</span></a></span><span>
</span><span id="line-308"></span><span>
</span><span id="line-309"></span><span class="hs-comment">-- | If the argument is given, returns it. Otherwise searches for the default</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- trash location.</span><span>
</span><span id="line-311"></span><span class="hs-comment">--</span><span>
</span><span id="line-312"></span><span class="hs-comment">-- @since 0.1</span><span>
</span><span id="line-313"></span><span id="local-6989586621679300614"><span class="annot"><a href="SafeRm.Runner.html#trashOrDefault"><span class="hs-identifier hs-type">trashOrDefault</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-314"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-315"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadCallStack.html#MonadCallStack"><span class="hs-identifier hs-type">MonadCallStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300614"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-316"></span><span>    </span><span class="annot"><a href="file:///nix/store/bxq9j5gs109r9hsk1856fwbn5zhqzn69-unliftio-core-0.2.0.1-doc/share/doc/unliftio-core-0.2.0.1/html/src/Control.Monad.IO.Unlift.html#MonadUnliftIO"><span class="hs-identifier hs-type">MonadUnliftIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300614"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-317"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-318"></span><span>  </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Data.Paths.html#PathI"><span class="hs-identifier hs-type">PathI</span></a></span><span> </span><span class="annot"><a href="SafeRm.Data.Paths.html#TrashHome"><span class="hs-identifier hs-type">TrashHome</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-319"></span><span>  </span><span class="annot"><a href="#local-6989586621679300614"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Data.Paths.html#PathI"><span class="hs-identifier hs-type">PathI</span></a></span><span> </span><span class="annot"><a href="SafeRm.Data.Paths.html#TrashHome"><span class="hs-identifier hs-type">TrashHome</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-320"></span><span id="trashOrDefault"><span class="annot"><span class="annottext">trashOrDefault :: forall (m :: * -&gt; *).
(HasCallStack, MonadCallStack m, MonadUnliftIO m) =&gt;
Maybe (PathI 'TrashHome) -&gt; m (PathI 'TrashHome)
</span><a href="SafeRm.Runner.html#trashOrDefault"><span class="hs-identifier hs-var hs-var">trashOrDefault</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *).
(HasCallStack, MonadCallStack m, MonadUnliftIO m) =&gt;
m (PathI 'TrashHome)
</span><a href="SafeRm.Runner.html#getTrashHome"><span class="hs-identifier hs-var">getTrashHome</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-comment">-- | Retrieves the default trash directory.</span><span>
</span><span id="line-323"></span><span class="hs-comment">--</span><span>
</span><span id="line-324"></span><span class="hs-comment">-- @since 0.1</span><span>
</span><span id="line-325"></span><span id="local-6989586621679300547"><span class="annot"><a href="SafeRm.Runner.html#getTrashHome"><span class="hs-identifier hs-type">getTrashHome</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Stack.Types.html#HasCallStack"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><a href="SafeRm.Effects.MonadCallStack.html#MonadCallStack"><span class="hs-identifier hs-type">MonadCallStack</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300547"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-328"></span><span>    </span><span class="annot"><a href="file:///nix/store/bxq9j5gs109r9hsk1856fwbn5zhqzn69-unliftio-core-0.2.0.1-doc/share/doc/unliftio-core-0.2.0.1/html/src/Control.Monad.IO.Unlift.html#MonadUnliftIO"><span class="hs-identifier hs-type">MonadUnliftIO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679300547"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-330"></span><span>  </span><span class="annot"><a href="#local-6989586621679300547"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="SafeRm.Data.Paths.html#PathI"><span class="hs-identifier hs-type">PathI</span></a></span><span> </span><span class="annot"><a href="SafeRm.Data.Paths.html#TrashHome"><span class="hs-identifier hs-type">TrashHome</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-331"></span><span id="getTrashHome"><span class="annot"><span class="annottext">getTrashHome :: forall (m :: * -&gt; *).
(HasCallStack, MonadCallStack m, MonadUnliftIO m) =&gt;
m (PathI 'TrashHome)
</span><a href="SafeRm.Runner.html#getTrashHome"><span class="hs-identifier hs-var hs-var">getTrashHome</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (i :: PathIndex). String -&gt; PathI i
</span><a href="SafeRm.Data.Paths.html#MkPathI"><span class="hs-identifier hs-var">MkPathI</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/filepath-1.4.2.2/src/System.FilePath.Posix.html#%3C%2F%3E"><span class="hs-operator hs-var">&lt;/&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;.trash&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="file:///nix/store/8bm45xdk5sakpc30lam9f739izchy80h-ghc-9.2.4-doc/share/doc/ghc/html/libraries/base-4.16.3.0/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a.
(HasCallStack, MonadCallStack m, MonadUnliftIO m) =&gt;
m a -&gt; m a
</span><a href="SafeRm.Exception.html#withStackTracing"><span class="hs-identifier hs-var">withStackTracing</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). MonadIO m =&gt; m String
</span><a href="file:///nix/store/smv0bjih6fh6klcs4cwm4ak4dy74hvmn-unliftio-0.2.22.0-doc/share/doc/unliftio-0.2.22.0/html/src/UnliftIO.Directory.html#getHomeDirectory"><span class="hs-identifier hs-var">Dir.getHomeDirectory</span></a></span><span>
</span><span id="line-332"></span></pre></body></html>